import{a as e}from"./index-ae6c698a.js";import{D as t}from"./DynamicTable-fb44771c.js";import{e as a}from"./eventBus-71c6ad98.js";import{i as l,a as o}from"./ipcRenderer-36c8fd5f.js";import{_ as s,o as i,c as n,a as r,F as d,f as c,t as g,r as m,h as p,j as u,b as h,e as _,d as b,p as v,g as f,v as x}from"./index-c3624d72.js";const y={class:"preprocess-image-container"},D={class:"button-area"},U={class:"image-area"},j={class:"image-text"},I={class:"image-box"},k=["src"];const V={components:{DynamicTable:t,PreprocessImages:s({components:{},name:"PreprocessImages",data:()=>({server_url:"http://127.0.0.1:7074",image_url:"",gray_image_url:"",binary_image_url:"",image_url_list:[]}),mounted(){a.on("RadioVertical.vue",(e=>{this.image_url=e}))},methods:{fetchProcessImages(){if(console.log("fetch"),""==this.image_url)return void this.$message.error("请先选择一张图片");const t={key:this.image_url},a=this.server_url+"/api/fetch_process_images";e.post(a,t).then((e=>{const t=e.data;console.log("post success: "+JSON.stringify(t)),console.log("post response_data: "+t.response_data);let a=t.response_data;for(let l=0;l<a.length;l++)console.log("打印名字: ",a[l].name);this.image_url_list=a,this.$message.success("请求处理成功")})).catch((e=>{console.log("发送请求错误：",e),this.$message.error("请求处理错误")}))}}},[["render",function(e,t,a,l,o,s){return i(),n("div",y,[r("div",D,[r("button",{onClick:t[0]||(t[0]=e=>s.fetchProcessImages())},"获取处理过程图片")]),r("div",U,[(i(!0),n(d,null,c(o.image_url_list,((e,t)=>(i(),n("div",{class:"image-boxes",key:t},[r("div",j,g(e.name),1),r("div",I,[r("img",{src:e.image_url,alt:"Image"},null,8,k)])])))),128))])])}],["__scopeId","data-v-99aba1d3"]])},name:"TableDisplayer",mounted(){a.on("RadioVertical.vue",(e=>{this.image_url=e}))},computed:{tableDataForTextArea:{get(){return JSON.stringify(this.tableData)},set(e){const t=e;try{const e=JSON.parse(t);this.tableData=e}catch{this.$message.error("json格式错误")}console.log(obj)}}},methods:{async fetchOCR(){try{this.loading=!0;const a=this.serverUrl+"/api/get_table",l=await e.get(a);this.responseData=l.data,console.log(this.responseData),console.log(this.responseData.message);var t=JSON.parse(this.responseData.message);console.log(t),this.tableData=t}catch(a){console.error("请求错误:",a)}finally{this.loading=!1}},postImageUrl(){const t={key:this.image_url};e.post("http://127.0.0.1:7074/api/post_data",t).then((e=>{const t=e.data;console.log("post success: "+JSON.stringify(t)),console.log("post response_data: "+t.response_data);var a=JSON.parse(t.response_data);this.tableData=a,console.log(this.tableData),this.$message.success("请求处理成功")})).catch((e=>{console.log("发送请求错误：",e),this.$message.error("请求处理错误")}))},test(e){this.tableData=e},generateXLSX(){const e=JSON.stringify(this.tableData);console.log("test",e),l.invoke(o.generateXLSX,e).then((e=>{console.log("res:",e)}))},saveTableData(){const e={function_name:"addForm",tableData:JSON.stringify(this.tableData)};l.invoke(o.formDbOperation,e).then((e=>{console.log("saveTableData(): ",e),this.$message.success("保存成功")}))}},data:()=>({serverUrl:"http://127.0.0.1:7074",responseData:"",enableEdit:!1,image_url:"",tableData:{name:"示例表格",description:"关于表格的描述",cells:[{content:"全宗号",left:0,right:1,top:0,bottom:1},{content:"年度",left:1,right:2,top:0,bottom:1},{content:"室编件号",left:2,right:4,top:0,bottom:1},{content:"馆编件号",left:4,right:6,top:0,bottom:1},{content:"盒号",left:6,right:7,top:0,bottom:1},{content:"220",left:0,right:1,top:1,bottom:2},{content:"2003",left:1,right:2,top:1,bottom:2},{content:"无",left:2,right:4,top:1,bottom:2},{content:"92",left:4,right:6,top:1,bottom:2},{content:"无",left:6,right:7,top:1,bottom:2},{content:"机构(问题)",left:0,right:3,top:2,bottom:3},{content:"保管期限",left:3,right:5,top:2,bottom:3},{content:"文书号",left:5,right:6,top:2,bottom:3},{content:"页数",left:6,right:7,top:2,bottom:3},{content:"防控组",left:0,right:3,top:3,bottom:4},{content:"长期",left:3,right:5,top:3,bottom:4},{content:"90",left:5,right:6,top:3,bottom:4},{content:"5",left:6,right:7,top:3,bottom:4}]}})},O=e=>(v("data-v-b01090e2"),e=e(),f(),e),C={class:"container"},S={class:"button-area"},R={class:"display-area"},T=O((()=>r("label",{for:""},"表格名称:",-1))),w=O((()=>r("br",null,null,-1))),J=O((()=>r("br",null,null,-1))),N=O((()=>r("label",{for:""},"表格描述:",-1))),M={key:0,class:"edit-area"},$=["onUpdate:modelValue"],P=["onUpdate:modelValue"],E=["onUpdate:modelValue"],F=["onUpdate:modelValue"],G=["onUpdate:modelValue"],X={class:"preprocess-images-area"};const A=s(V,[["render",function(e,t,a,l,o,s){const v=m("dynamic-table"),f=m("preprocess-images");return i(),n("div",C,[r("div",S,[r("button",{onClick:t[0]||(t[0]=e=>s.postImageUrl())},"发送图像"),r("button",{onClick:t[1]||(t[1]=e=>this.enableEdit=!this.enableEdit)},g(o.enableEdit?"关闭表格编辑":"启用表格编辑"),1),r("button",{onClick:t[2]||(t[2]=e=>s.saveTableData())},"保存表格")]),r("div",R,[T,w,p(r("input",{class:"wide-input",type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>o.tableData.name=e)},null,512),[[u,o.tableData.name]]),J,N,p(r("textarea",{"onUpdate:modelValue":t[4]||(t[4]=e=>o.tableData.description=e),rows:"3"},null,512),[[u,o.tableData.description]]),h(v,{data:o.tableData},null,8,["data"]),o.enableEdit?(i(),n("div",M,[r("table",null,[r("tbody",null,[(i(!0),n(d,null,c(o.tableData.cells,((e,t)=>(i(),n("tr",{key:t},[r("td",null,[b(" 单元格内容： "),p(r("input",{type:"text","onUpdate:modelValue":e=>o.tableData.cells[t].content=e},null,8,$),[[u,o.tableData.cells[t].content]])]),r("td",null,[r("tr",null,[r("td",null,[b(" 左: "),p(r("input",{type:"text","onUpdate:modelValue":e=>o.tableData.cells[t].left=e},null,8,P),[[u,o.tableData.cells[t].left]])]),r("td",null,[b(" 右: "),p(r("input",{type:"text","onUpdate:modelValue":e=>o.tableData.cells[t].right=e},null,8,E),[[u,o.tableData.cells[t].right]])])]),r("tr",null,[r("td",null,[b(" 上: "),p(r("input",{type:"text","onUpdate:modelValue":e=>o.tableData.cells[t].top=e},null,8,F),[[u,o.tableData.cells[t].top]])]),r("td",null,[b(" 下: "),p(r("input",{type:"text","onUpdate:modelValue":e=>o.tableData.cells[t].bottom=e},null,8,G),[[u,o.tableData.cells[t].bottom]])])])])])))),128))])])])):_("",!0),r("div",X,[h(f)])])])}],["__scopeId","data-v-b01090e2"]]),q={data:()=>({tableData:[{imageUrl:"path/to/image1.jpg",text:"这是图片1的文字信息"},{imageUrl:"path/to/image2.jpg",text:"这是图片2的文字信息"},{imageUrl:"path/to/image3.jpg",text:"这是图片3的文字信息"},{imageUrl:"path/to/image1.jpg",text:"这是图片1的文字信息"},{imageUrl:"path/to/image2.jpg",text:"这是图片2的文字信息"},{imageUrl:"path/to/image3.jpg",text:"这是图片3的文字信息"},{imageUrl:"path/to/image1.jpg",text:"这是图片1的文字信息"},{imageUrl:"path/to/image2.jpg",text:"这是图片2的文字信息"},{imageUrl:"path/to/image3.jpg",text:"这是图片3的文字信息"},{imageUrl:"path/to/image1.jpg",text:"这是图片1的文字信息"},{imageUrl:"path/to/image2.jpg",text:"这是图片2的文字信息"},{imageUrl:"path/to/image3.jpg",text:"这是图片3的文字信息"},{imageUrl:"path/to/image1.jpg",text:"这是图片1的文字信息"},{imageUrl:"path/to/image2.jpg",text:"这是图片2的文字信息"},{imageUrl:"path/to/image3.jpg",text:"这是图片3的文字信息"},{imageUrl:"path/to/image1.jpg",text:"这是图片1的文字信息"},{imageUrl:"path/to/image2.jpg",text:"这是图片2的文字信息"},{imageUrl:"path/to/image3.jpg",text:"这是图片3的文字信息"},{imageUrl:"path/to/image1.jpg",text:"这是图片1的文字信息"},{imageUrl:"path/to/image2.jpg",text:"这是图片2的文字信息"},{imageUrl:"path/to/image3.jpg",text:"这是图片3的文字信息"}]}),methods:{"识别"(e){console.log("识别图片"+e)},"查看"(e){console.log("查看图片"+e)}}},L={class:"table-container"},z=(e=>(v("data-v-dcf7e8dd"),e=e(),f(),e))((()=>r("thead",null,[r("tr",null,[r("th",null,"图片"),r("th",null,"文字信息"),r("th",null,"操作")])],-1))),B=["src"],H=["onClick"],K=["onClick"];const Q=s(q,[["render",function(e,t,a,l,o,s){return i(),n("div",L,[r("table",null,[z,r("tbody",null,[(i(!0),n(d,null,c(o.tableData,((e,t)=>(i(),n("tr",{key:t},[r("td",null,[r("img",{src:e.imageUrl,alt:"图片"},null,8,B)]),r("td",null,g(e.text),1),r("td",null,[r("button",{onClick:e=>s.识别(t)},"识别",8,H),r("button",{onClick:e=>s.查看(t)},"查看",8,K)])])))),128))])])])}],["__scopeId","data-v-dcf7e8dd"]]),W={class:"container"},Y={class:"area1"},Z=["src"],ee=["value"],te={class:"area2"},ae={class:"area2-head"},le={class:"area2-body"},oe=["src"];const se={class:"container"},ie={class:"area1"},ne={class:"area2-head"},re={class:"area2-body"},de=["src"],ce={key:0,class:"modal-overlay"},ge={class:"modal"},me=["src"],pe={class:"area2"},ue=["src"],he=["value"];const _e={components:{Radio:s({components:{ImageTable:Q},name:"Radio",data:()=>({image_data:[],selected_image_tag:"",selected_image_index:0}),mounted(){console.log("mounted: 组件已挂载"),this.dbGetImages(),console.log(this.image_data)},computed:{selected_image_url(){return this.image_data.length<=0?"":(this.emit(this.image_data[this.selected_image_index].image_url),this.image_data[this.selected_image_index].image_url)}},methods:{dbGetImages(){l.invoke(o.sqlitedbOperation,{function_name:"getAllImages"}).then((e=>{console.log("res:",e),this.image_data=e.all_list,console.log(this.image_data)}))},emit(e){console.log("触发emit: "+e),a.emit("Radio.vue",e)}}},[["render",function(e,t,a,l,o,s){return i(),n("div",W,[r("div",Y,[r("table",null,[r("tbody",null,[(i(!0),n(d,null,c(o.image_data,((e,a)=>(i(),n("tr",{key:a},[r("td",null,[r("img",{class:"radio-img",src:e.image_url,alt:"Image"},null,8,Z)]),r("td",null,g(e.tag),1),r("td",null,[p(r("input",{type:"radio",value:a,"onUpdate:modelValue":t[0]||(t[0]=e=>o.selected_image_index=e)},null,8,ee),[[x,o.selected_image_index]])])])))),128))])])]),r("div",te,[r("div",ae," 当前选择: "+g(o.selected_image_index),1),r("div",le,[r("img",{class:"selected-img",src:s.selected_image_url,alt:"Image"},null,8,oe)])])])}],["__scopeId","data-v-73ebc8f2"]]),ProcessDisplayer:A,RadioVertical:s({components:{ImageTable:Q},name:"RadioVertical",data:()=>({image_data:[],selected_image_tag:"",selected_image_index:0,showModal:!1}),mounted(){console.log("mounted: 组件已挂载"),this.dbGetImages(),console.log(this.image_data)},computed:{selected_image_url(){return this.image_data.length<=0?"":(this.emit(this.image_data[this.selected_image_index].image_url),this.image_data[this.selected_image_index].image_url)}},methods:{closeModal(){this.showModal=!1},dbGetImages(){l.invoke(o.sqlitedbOperation,{function_name:"getAllImages"}).then((e=>{console.log("res:",e),this.image_data=e.all_list,console.log(this.image_data)}))},emit(e){a.emit("RadioVertical.vue",e)}}},[["render",function(e,t,a,l,o,s){return i(),n("div",se,[r("div",ie,[r("div",ne," 当前选择: "+g(o.selected_image_index),1),r("div",re,[r("img",{class:"selected-img",src:s.selected_image_url,alt:"Image",onClick:t[0]||(t[0]=e=>o.showModal=!0)},null,8,de)]),o.showModal?(i(),n("div",ce,[r("div",ge,[r("img",{src:s.selected_image_url,alt:"Full Size Image"},null,8,me),r("button",{onClick:t[1]||(t[1]=(...e)=>s.closeModal&&s.closeModal(...e))},"关闭")])])):_("",!0)]),r("div",pe,[r("table",null,[r("tbody",null,[(i(!0),n(d,null,c(o.image_data,((e,a)=>(i(),n("tr",{key:a},[r("td",null,[r("img",{class:"radio-img",src:e.image_url,alt:"Image"},null,8,ue)]),r("td",null,[p(r("input",{type:"radio",value:a,"onUpdate:modelValue":t[2]||(t[2]=e=>o.selected_image_index=e)},null,8,he),[[x,o.selected_image_index]])])])))),128))])])])])}],["__scopeId","data-v-497114f4"]])},name:"Process",data:()=>({})},be={class:"view"},ve=(e=>(v("data-v-2afaf9ef"),e=e(),f(),e))((()=>r("div",{style:{"padding-left":"4px"}},[r("h2",null,"识别图片")],-1))),fe={class:"body-area"},xe={class:"left-area"},ye={class:"right-area"};const De=s(_e,[["render",function(e,t,a,l,o,s){const d=m("radio-vertical"),c=m("process-displayer");return i(),n("div",be,[ve,r("div",fe,[r("div",xe,[h(d)]),r("div",ye,[h(c)])])])}],["__scopeId","data-v-2afaf9ef"]]);export{De as default};
