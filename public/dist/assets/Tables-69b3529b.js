import{a as t}from"./index-ae6c698a.js";import{D as e}from"./DynamicTable-fb44771c.js";import{e as a}from"./eventBus-71c6ad98.js";import{i as l,a as o}from"./ipcRenderer-36c8fd5f.js";import{_ as n,r as s,o as i,c as d,a as r,t as c,b as p,e as b,F as u,f as h,d as m,h as g,j as f,p as D,g as y}from"./index-c3624d72.js";const v={class:"container"},k={class:"button-area"},U={key:1,class:"edit-area"},x=["onUpdate:modelValue"],V=["onUpdate:modelValue"],S=["onUpdate:modelValue"],_=["onUpdate:modelValue"],P=["onUpdate:modelValue"];const O=n({components:{DynamicTable:e},name:"TableDisplayer",mounted(){a.on("Radio.vue",(t=>{console.log("监听on: "+t),this.image_url=t}))},computed:{tableDataForTextArea:{get(){return JSON.stringify(this.tableData)},set(t){const e=t;try{const t=JSON.parse(e);this.tableData=t}catch{this.$message.error("json格式错误")}console.log(obj)}}},methods:{async fetchOCR(){try{this.loading=!0;const a=this.serverUrl+"/api/get_table",l=await t.get(a);this.responseData=l.data,console.log(this.responseData),console.log(this.responseData.message);var e=JSON.parse(this.responseData.message);console.log(e),this.tableData=e}catch(a){console.error("请求错误:",a)}finally{this.loading=!1}},postImageUrl(){const e={key:this.image_url};t.post("http://127.0.0.1:7074/api/post_data",e).then((t=>{const e=t.data;console.log("post success: "+JSON.stringify(e)),console.log("post response_data: "+e.response_data);var a=JSON.parse(e.response_data);this.tableData=a,console.log(this.tableData),this.$message.success("请求处理成功")})).catch((t=>{console.log("发送请求错误：",t),this.$message.error("请求处理错误")}))},test(t){this.tableData=t},generateXLSX(){const t=JSON.stringify(this.tableData);console.log("test",t),l.invoke(o.generateXLSX,t).then((t=>{console.log("res:",t)}))}},data:()=>({serverUrl:"http://127.0.0.1:7074",responseData:"",enableEdit:!1,image_url:"",tableData:{name:"demo",cells:[{content:"全宗号",left:0,right:1,top:0,bottom:1},{content:"年度",left:1,right:2,top:0,bottom:1},{content:"室编件号",left:2,right:4,top:0,bottom:1},{content:"馆编件号",left:4,right:6,top:0,bottom:1},{content:"盒号",left:6,right:7,top:0,bottom:1},{content:"220",left:0,right:1,top:1,bottom:2},{content:"2003",left:1,right:2,top:1,bottom:2},{content:"无",left:2,right:4,top:1,bottom:2},{content:"92",left:4,right:6,top:1,bottom:2},{content:"无",left:6,right:7,top:1,bottom:2},{content:"机构(问题)",left:0,right:3,top:2,bottom:3},{content:"保管期限",left:3,right:5,top:2,bottom:3},{content:"文书号",left:5,right:6,top:2,bottom:3},{content:"页数",left:6,right:7,top:2,bottom:3},{content:"防控组",left:0,right:3,top:3,bottom:4},{content:"长期",left:3,right:5,top:3,bottom:4},{content:"90",left:5,right:6,top:3,bottom:4},{content:"5",left:6,right:7,top:3,bottom:4}]}})},[["render",function(t,e,a,l,o,n){const D=s("dynamic-table");return i(),d("div",v,[r("div",k,[r("button",{onClick:e[0]||(e[0]=t=>this.enableEdit=!this.enableEdit)},c(o.enableEdit?"关闭表格编辑":"启用表格编辑"),1),r("button",{onClick:e[1]||(e[1]=t=>n.generateXLSX())},"生成表格文件")]),p(D,{data:o.tableData},null,8,["data"]),b("",!0),o.enableEdit?(i(),d("div",U,[r("table",null,[r("tbody",null,[(i(!0),d(u,null,h(o.tableData.cells,((t,e)=>(i(),d("tr",{key:e},[r("td",null,[m(" 单元格内容： "),g(r("input",{type:"text","onUpdate:modelValue":t=>o.tableData.cells[e].content=t},null,8,x),[[f,o.tableData.cells[e].content]])]),r("td",null,[r("tr",null,[r("td",null,[m(" 左： "),g(r("input",{type:"text","onUpdate:modelValue":t=>o.tableData.cells[e].left=t},null,8,V),[[f,o.tableData.cells[e].left]])]),r("td",null,[m(" 右： "),g(r("input",{type:"text","onUpdate:modelValue":t=>o.tableData.cells[e].right=t},null,8,S),[[f,o.tableData.cells[e].right]])])]),r("tr",null,[r("td",null,[m(" 上: "),g(r("input",{type:"text","onUpdate:modelValue":t=>o.tableData.cells[e].top=t},null,8,_),[[f,o.tableData.cells[e].top]])]),r("td",null,[m(" 下: "),g(r("input",{type:"text","onUpdate:modelValue":t=>o.tableData.cells[e].bottom=t},null,8,P),[[f,o.tableData.cells[e].bottom]])])])])])))),128))])])])):b("",!0)])}],["__scopeId","data-v-d909dd1e"]]),F={components:{DynamicTable:e},data:()=>({data:[{id:1,tableData:"table1"}],tableData:{name:"demo",cells:[{content:"全宗号",left:0,right:1,top:0,bottom:1},{content:"年度",left:1,right:2,top:0,bottom:1},{content:"室编件号",left:2,right:4,top:0,bottom:1},{content:"馆编件号",left:4,right:6,top:0,bottom:1},{content:"盒号",left:6,right:7,top:0,bottom:1},{content:"220",left:0,right:1,top:1,bottom:2},{content:"2003",left:1,right:2,top:1,bottom:2},{content:"无",left:2,right:4,top:1,bottom:2},{content:"92",left:4,right:6,top:1,bottom:2},{content:"无",left:6,right:7,top:1,bottom:2},{content:"机构(问题)",left:0,right:3,top:2,bottom:3},{content:"保管期限",left:3,right:5,top:2,bottom:3},{content:"文书号",left:5,right:6,top:2,bottom:3},{content:"页数",left:6,right:7,top:2,bottom:3},{content:"防控组",left:0,right:3,top:3,bottom:4},{content:"长期",left:3,right:5,top:3,bottom:4},{content:"90",left:5,right:6,top:3,bottom:4},{content:"5",left:6,right:7,top:3,bottom:4}]},checkedId:"",pageSize:10,currentPage:1,showModal:!1}),mounted(){this.fetchForms()},computed:{totalPages(){return Math.ceil(this.data.length/this.pageSize)},paginatedData(){const t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;return this.data.slice(t,e)}},methods:{previousPage(){this.currentPage>1&&this.currentPage--},nextPage(){this.currentPage<this.totalPages&&this.currentPage++},fetchForms(){l.invoke(o.formDbOperation,{function_name:"getAllForms"}).then((t=>{this.data=t.all_list;for(let e=0;e<this.data.length;e++)this.data[e].tableData=JSON.parse(this.data[e].tableData);console.log(this.data)}))},deleteForm(t){const e={function_name:"delFormById",id:t};l.invoke(o.formDbOperation,e).then((t=>{this.$message.success("删除成功"),this.data=t.all_list;for(let e=0;e<this.data.length;e++)this.data[e].tableData=JSON.parse(this.data[e].tableData)}))},checkForm(t){this.showModal=!this.showModal,this.tableData=this.data[t].tableData,this.checkedId=this.data[t].id},updateForm(){if(""==this.checkedId)return;const t={function_name:"updateFormById",id:this.checkedId,tableData:JSON.stringify(this.tableData)};l.invoke(o.formDbOperation,t).then((t=>{this.$message.success("更新成功"),this.data=t.all_list;for(let e=0;e<this.data.length;e++)this.data[e].tableData=JSON.parse(this.data[e].tableData)}))},generateXLSX(){const t={id:this.checkedId,tableData:JSON.stringify(this.tableData)};l.invoke(o.generateXLSX,t).then((t=>{console.log("res:",t)}))}}},C=t=>(D("data-v-cd134faa"),t=t(),y(),t),X={class:"table-paginated-list-container"},I={key:0,class:"modal-overlay"},J={class:"modal"},N={class:"modal-button-area"},w={class:"modal-edit-area"},j=C((()=>r("label",{for:""},"表格名称:",-1))),M=C((()=>r("br",null,null,-1))),T=C((()=>r("br",null,null,-1))),L=C((()=>r("label",{for:""},"表格描述:",-1))),E=C((()=>r("br",null,null,-1))),$={class:"edit-area"},z=["onUpdate:modelValue"],B=["onUpdate:modelValue"],R=["onUpdate:modelValue"],A=["onUpdate:modelValue"],q=["onUpdate:modelValue"],G={class:"button-area"},H=["disabled"],K=["disabled"],Q={class:"table-area"},W=C((()=>r("thead",null,[r("th",null,"序号"),r("th",null,"名称"),r("th",null,"描述"),r("th",null,"操作")],-1))),Y=["onClick"],Z=["onClick"];const tt={components:{TableManager:O,TablePaginatedList:n(F,[["render",function(t,e,a,l,o,n){const D=s("dynamic-table");return i(),d("div",X,[o.showModal?(i(),d("div",I,[r("div",J,[r("div",N,[r("button",{onClick:e[0]||(e[0]=t=>o.showModal=!o.showModal)},"关闭"),r("button",{onClick:e[1]||(e[1]=t=>n.updateForm())},"更新"),r("button",{onClick:e[2]||(e[2]=t=>n.generateXLSX())},"导出xlsx")]),r("div",w,[p(D,{data:o.tableData},null,8,["data"]),j,M,g(r("input",{class:"wide-input",type:"text","onUpdate:modelValue":e[3]||(e[3]=t=>o.tableData.name=t)},null,512),[[f,o.tableData.name]]),T,L,E,g(r("textarea",{"onUpdate:modelValue":e[4]||(e[4]=t=>o.tableData.description=t),rows:"3"},null,512),[[f,o.tableData.description]]),r("div",$,[r("table",null,[r("tbody",null,[(i(!0),d(u,null,h(o.tableData.cells,((t,e)=>(i(),d("tr",{key:e},[r("td",null,[m(" 单元格内容： "),g(r("input",{type:"text","onUpdate:modelValue":t=>o.tableData.cells[e].content=t},null,8,z),[[f,o.tableData.cells[e].content]])]),r("td",null,[r("tr",null,[r("td",null,[m(" 左: "),g(r("input",{type:"text","onUpdate:modelValue":t=>o.tableData.cells[e].left=t},null,8,B),[[f,o.tableData.cells[e].left]])]),r("td",null,[m(" 右: "),g(r("input",{type:"text","onUpdate:modelValue":t=>o.tableData.cells[e].right=t},null,8,R),[[f,o.tableData.cells[e].right]])])]),r("tr",null,[r("td",null,[m(" 上: "),g(r("input",{type:"text","onUpdate:modelValue":t=>o.tableData.cells[e].top=t},null,8,A),[[f,o.tableData.cells[e].top]])]),r("td",null,[m(" 下: "),g(r("input",{type:"text","onUpdate:modelValue":t=>o.tableData.cells[e].bottom=t},null,8,q),[[f,o.tableData.cells[e].bottom]])])])])])))),128))])])])])])])):b("",!0),r("div",G,[r("button",{onClick:e[5]||(e[5]=(...t)=>n.previousPage&&n.previousPage(...t)),disabled:1===o.currentPage},"上一页",8,H),r("button",{onClick:e[6]||(e[6]=(...t)=>n.nextPage&&n.nextPage(...t)),disabled:o.currentPage===n.totalPages},"下一页",8,K)]),r("div",Q,[r("table",null,[W,r("tbody",null,[(i(!0),d(u,null,h(n.paginatedData,((t,e)=>(i(),d("tr",{key:t.id},[r("td",null,c(t.id),1),r("td",null,c(t.tableData.name),1),r("td",null,c(t.tableData.description),1),r("td",null,[r("button",{onClick:t=>n.checkForm(e)},"查看",8,Y),r("button",{onClick:e=>n.deleteForm(t.id)},"删除",8,Z)])])))),128))])])])])}],["__scopeId","data-v-cd134faa"]])},name:"Tables",data:()=>({})},et={class:"view"},at=(t=>(D("data-v-149f9943"),t=t(),y(),t))((()=>r("div",{style:{"padding-left":"4px"}},[r("h2",null,"管理表格")],-1))),lt={class:"body-area"};const ot=n(tt,[["render",function(t,e,a,l,o,n){const c=s("table-paginated-list");return i(),d("div",et,[at,r("div",lt,[p(c)])])}],["__scopeId","data-v-149f9943"]]);export{ot as default};
